# Приложение учета отгрузки стройматериалов

## Описание

Приложение для учета отгрузки стройматериалов, разработанное на C# с использованием Windows Forms и ADO.NET для работы с PostgreSQL.

## Функциональность

### Основные возможности:
- **Управление стройматериалами**: добавление, редактирование, удаление материалов с указанием цены и остатков на складе
- **Управление заказчиками**: ведение базы клиентов с контактной информацией
- **Управление отгрузками**: создание и редактирование отгрузок с автоматическим расчетом сумм
- **Отчеты**: формирование отчетов по остаткам, отгрузкам и заказчикам с возможностью экспорта в CSV

### Технические особенности:
- Использование ADO.NET для работы с PostgreSQL
- Асинхронные операции для работы с базой данных
- Автоматическое обновление остатков на складе при отгрузке
- Валидация данных на уровне формы
- Генерация уникальных номеров отгрузок

## Требования

- .NET 8.0 или выше
- PostgreSQL 12 или выше
- Windows 10/11

## Установка и настройка

### 1. Установка PostgreSQL

Скачайте и установите PostgreSQL с официального сайта: https://www.postgresql.org/download/

### 2. Создание базы данных

1. Откройте pgAdmin или подключитесь к PostgreSQL через командную строку
2. Выполните SQL скрипт из файла `database_schema.sql` для создания базы данных и таблиц

```sql
-- Выполните команды из database_schema.sql
```

### 3. Настройка подключения

Откройте файл `appsettings.json` и измените параметры подключения:

```json
{
  "DatabaseSettings": {
    "Host": "localhost",
    "Port": 5432,
    "Database": "construction_materials_db",
    "Username": "postgres",
    "Password": "ваш_пароль_postgres"
  }
}
```

**Важно**: Замените `"ваш_пароль_postgres"` на ваш реальный пароль от PostgreSQL.

### 4. Сборка и запуск

1. Откройте проект в Visual Studio или используйте командную строку:
```bash
dotnet build
dotnet run
```

## Структура проекта

```
RIS_p2-LR5/
├── Data/
│   └── DatabaseConnection.cs      # Класс для подключения к БД
├── Models/
│   ├── Material.cs                 # Модель стройматериала
│   ├── Customer.cs                 # Модель заказчика
│   ├── Shipment.cs                 # Модель отгрузки
│   └── ShipmentDetail.cs           # Модель детали отгрузки
├── Services/
│   ├── MaterialService.cs          # Сервис для работы с материалами
│   ├── CustomerService.cs          # Сервис для работы с заказчиками
│   └── ShipmentService.cs          # Сервис для работы с отгрузками
├── Forms/
│   ├── MaterialForm.cs             # Форма управления материалами
│   ├── CustomerForm.cs             # Форма управления заказчиками
│   ├── ShipmentForm.cs             # Форма управления отгрузками
│   └── ReportsForm.cs              # Форма отчетов
├── Form1.cs                        # Главная форма приложения
├── Program.cs                      # Точка входа в приложение
└── database_schema.sql             # SQL скрипт для создания БД
```

## Использование

### Работа с материалами
1. Перейдите на вкладку "Стройматериалы"
2. Нажмите "Добавить" для создания нового материала
3. Заполните все обязательные поля (название, единица измерения, цена)
4. Нажмите "Сохранить"

### Работа с заказчиками
1. Перейдите на вкладку "Заказчики"
2. Нажмите "Добавить" для создания нового заказчика
3. Заполните информацию о компании
4. Нажмите "Сохранить"

### Создание отгрузки
1. Перейдите на вкладку "Отгрузки"
2. Нажмите "Создать отгрузку"
3. Выберите заказчика и дату отгрузки
4. Добавьте материалы в отгрузку, указав количество
5. Нажмите "Сохранить" - остатки на складе обновятся автоматически

### Просмотр отчетов
1. Нажмите кнопку "Отчеты" в главном окне
2. Выберите нужный тип отчета на вкладке
3. Используйте кнопку "Экспорт в CSV" для сохранения отчета

## База данных

### Основные таблицы:

- **Materials** - справочник стройматериалов
- **Customers** - справочник заказчиков  
- **Shipments** - отгрузки
- **ShipmentDetails** - детали отгрузок

### Связи:
- Отгрузка связана с заказчиком (один ко многим)
- Деталь отгрузки связана с отгрузкой и материалом (многие ко многим)

## Возможные проблемы и решения

### Ошибка подключения к базе данных
- Проверьте, что PostgreSQL запущен
- Убедитесь в правильности параметров подключения
- Проверьте права доступа пользователя к базе данных

### Ошибки при создании отгрузки
- Убедитесь, что на складе достаточно материалов
- Проверьте, что выбраны заказчик и материалы

### Проблемы с экспортом отчетов
- Убедитесь, что у приложения есть права на запись в выбранную папку
- Проверьте, что файл не открыт в другой программе

## Разработка

Для разработки рекомендуется:
- Visual Studio 2022 или выше
- PostgreSQL с pgAdmin
- Git для версионного контроля

## Лицензия

Проект создан в учебных целях.
